var cmsRoot="www",cmsUrl="",cmsUrls="",cmsId="",initRS=!1,pg="",$jsRoot="",appCvgx=angular.module("ngCvgxApp",["ui.bootstrap","ngSanitize"]);appCvgx.controller("cvgxController",function(t,e){t.pg=pg,t.friendly=cmsUrl,t.id=cmsId,t.friendlys=cmsUrls.replace(/,$/,"").split(",").map(function(t){return{friendly:t}}),t.header="",t.headerBkg="",t.downArrowIcon='<i class="fa fa-angle-down"></i>',t.currentnav=top.location.pathname,t.currentnav=t.currentnav.substr(1,t.currentnav.length-1),t.agreeTandC="0",t.toggleAgreeTandC=function(){t.agreeTandC="0"==t.agreeTandC?"1":"0"},t.mainnav=[],t.productnav=[],t.footernav=[],t.content=[],t.children=[],t.multicontent=[],t.customField=function(e){var n=t.content["content-item"]["custom-field"],r="";for(x=0;x<n.length;x++)n[x].title==e&&(r=n[x]["#text"]);return r},t.pop=function(t){e.getContent(t).success(function(t){void 0==t.response&&($(".pop-content-title").text(t["content-item"].title),$(".pop-content-body").html(t["content-item"]["long-desc"]))}).error(function(t){})},t.getSingleContent=function(){e.getContent(t.friendly,t.id).success(function(e){if(t.content=e,void 0==t.content.response){t.header=t.customField("Page Title"),0==t.header.length&&(t.header=t.content["content-item"].title),t.headerBkg=t.customField("header-image/jpg"),initRS&&RevolutionSlider.initRShome();var n=new Date,r=n.getFullYear()-1997+(n.getFullYear()-1998);t.content["content-item"]["short-desc"]=t.content["content-item"]["short-desc"].replace(/##number-of-years##/g,r.toString()),t.content["content-item"]["long-desc"]=t.content["content-item"]["long-desc"].replace(/##number-of-years##/g,r.toString());for(var c=0;c<t.content["content-item"]["custom-field"].length;c++)"jpg1/jpg"==t.content["content-item"]["custom-field"][c].title?t.content["content-item"].imgSrc1=t.content["content-item"]["custom-field"][c]["#text"]:"jpg2/jpg"==t.content["content-item"]["custom-field"][c].title?t.content["content-item"].imgSrc2=t.content["content-item"]["custom-field"][c]["#text"]:"Author"==t.content["content-item"]["custom-field"][c].title&&(t.content["content-item"].author=t.content["content-item"]["custom-field"][c]["#text"]);if(void 0!=t.content["content-item"]["child-item"])if(t.children=t.content["content-item"]["child-item"],t.children.length>1)for(var i=0;i<t.children.length;i++){t.children[i].pubdate=t.children[i].pubdate.replace(/ /g,"T");for(c=0;c<t.children[i]["custom-field"].length;c++)"jpg1/jpg"==t.children[i]["custom-field"][c].title?t.children[i].imgSrc1=t.children[i]["custom-field"][c]["#text"]:"jpg2/jpg"==t.children[i]["custom-field"][c].title?t.children[i].imgSrc2=t.children[i]["custom-field"][c]["#text"]:"Author"==t.children[i]["custom-field"][c].title&&(t.children[i].author=t.children[i]["custom-field"][c]["#text"])}else if(t.children.length=1){t.children.pubdate=t.children.pubdate.replace(/ /g,"T");for(c=0;c<t.children["custom-field"].length;c++)"jpg1/jpg"==t.children["custom-field"][c].title?t.children.imgSrc1=t.children["custom-field"][c]["#text"]:"jpg2/jpg"==t.children["custom-field"][c].title?t.children.imgSrc2=t.children["custom-field"][c]["#text"]:"Author"==t.children["custom-field"][c].title&&(t.children.author=t.children["custom-field"][c]["#text"])}}$(".ng-waiting").show()}).error(function(t){})},(t.friendly.length>0||t.id.length>0)&&t.getSingleContent();var n={};t.getMultiContent=function(r){e.getContent(t.friendlys[r].friendly).success(function(e){if(void 0==e.response){var c=new Date,i=c.getFullYear()-1997+(c.getFullYear()-1998);e["content-item"]["short-desc"]=e["content-item"]["short-desc"].replace(/##number-of-years##/g,i.toString()),e["content-item"]["long-desc"]=e["content-item"]["long-desc"].replace(/##number-of-years##/g,i.toString()),n[t.friendlys[r].friendly]=e,t.friendlys.length>r+1?t.getMultiContent(r+1):t.multicontent=n}}).error(function(t){console.log(t)})},t.friendlys[0].friendly.length>0&&t.getMultiContent(0),e.getSitemap().success(function(e){for(x=0;x<e["nav-group"].length;x++)e["nav-group"][x].friendly==cmsRoot+"/main-nav"?t.mainnav=e["nav-group"][x]:e["nav-group"][x].friendly==cmsRoot+"/products-nav"?t.productnav=e["nav-group"][x]:e["nav-group"][x].friendly==cmsRoot+"/footer-nav"&&(t.footernav=e["nav-group"][x])}).error(function(t){}),t.trackNo="",t.trackCarrier="exds",t.tracking=[],t.tracking.pleaseWait=!1,t.tracking.hasData=null,t.tracking.carrier=null,t.tracking.carrierLogo=null,t.tracking.exds=null,t.tracking.dhl=null,t.tracking.dates=[],t.clearTracking=function(e){t.tracking=[],t.tracking.exds=null,t.tracking.dhl=null,t.tracking.carrier=null,t.tracking.carrierLogo=null,t.tracking.dates=[],t.tracking.pleaseWait=!1,t.tracking.hasData=null,(e=null!=e&&e)&&(t.trackNo=null),$("#trackNo").focus(),$("body").animate({scrollTop:0},200)},"track-a-package"==t.pg&&($(".ng-waiting").show(),t.clearTracking(!0)),t.getTracking=function(n){console.log(t.trackNo),null!=t.trackNo&&""!=t.trackNo&&(null==n&&(n="exds"),t.clearTracking(),t.tracking.pleaseWait=!0,t.tracking.hasData=null,e.getTracking(n,t.trackNo).success(function(e){if(null!=e){if(t.tracking.carrier=e["avion-express-track-waybill"].shipment.carrier,t.tracking.carrierLogo="/assets/img/partner-logos/"+t.tracking.carrier+"_med.jpg",t.tracking[n]=e["avion-express-track-waybill"],"exds"==n){(c=t.tracking.exds!=[]&&null!=t.tracking.exds.events?t.tracking.exds.events.event:[]).length>0&&(t.tracking.hasData=!0),t.tracking.exds.events=[],t.tracking.exds.events.event=[];var r="";for($$x=0;$$x<c.length;$$x++)t.tracking.exds.events.event.unshift(c[$$x]),r!=c[$$x].eventDate&&(r=c[$$x].eventDate,t.tracking.dates.unshift({Date:r,Weekday:t.getDay(r)}));c=[]}else if("dhl"==n){var c;(c=t.tracking.dhl!=[]?t.tracking.dhl.ShipmentEvent:[]).length>0&&(t.tracking.hasData=!0),t.tracking.dhl.ShipmentEvent=[];r="";for($$x=0;$$x<c.length;$$x++)t.tracking.dhl.ShipmentEvent.unshift(c[$$x]),r!=c[$$x].Date&&(r=c[$$x].Date,t.tracking.dates.unshift({Date:r,Weekday:t.getDay(r)}));c=[]}t.tracking.pleaseWait=!1}else"dhl"==n?t.getTracking("exds"):(t.tracking.hasData=!1,t.tracking.pleaseWait=!1)}))},$("#trackNo").on("keydown",function(e){void 0!=t.trackNo&&13==e.which&&t.getTracking()}),$("#trackNo").on("keyup",function(e){t.tracking.hasData=null,t.tracking.pleaseWait=!1,void 0==t.trackNo&&t.clearTracking(!0)}),$(".track-carrier").on("change",function(){void 0!=t.trackNo&&t.getTracking(!1)}),t.getDay=function(t){var e="";switch(new Date(t).getDay()){case 0:e="Sunday";break;case 1:e="Monday";break;case 2:e="Tuesday";break;case 3:e="Wednesday";break;case 4:e="Thursday";break;case 5:e="Friday";break;case 6:e="Saturday"}return e}}),appCvgx.factory("cvgxFactory",function(t){return{getContent:function(e,n){return t({method:"GET",url:$jsRoot+"/data/json-ripplecms.cshtml?friendly="+(e=void 0==e||null==e?"":e)+"&id="+(n=void 0==n||null==n?"":n),cache:!1})},getSitemap:function(){return t({method:"GET",url:$jsRoot+"/data/json-ripplecms.cshtml?type=sitemap",cache:!1})},getTracking:function(e,n){return console.log("/data/json-"+e+"?trackNo="+n),t({method:"GET",url:"/data/json-"+e+"?trackNo="+n,cache:!1})}}});